---
layout: post
category:
    - docs
    - computer-science
tags:
    - network
description: >
    프로토콜 계층에 대해서. (feat. OSI 7 layers)
---
# 프로토콜 계층

* toc
{:toc}

어떤 시스템이 계층 구조를 가지면 각 계층이 제공하는 서비스의 구현을 변경하는 것도 쉬우며 어떤 한 계층의 구현이 변하더라도 시스템의 나머지 부분은 변하지 않는다.**(서비스 구현의 변화 &ne; 서비스 자체의 변화)**  

시스템의 다른 요소에 영향을 주지 않고 서비스 구현을 변화시키는 능력은 계층화하는 중요한 이유중 하나이다.

그러한 관점에서 프로토콜의 계층화는 개념과 구조 측면에서 이점이 있다.([RFC3439](https://tools.ietf.org/html/rfc3439))

하지만 다른 관점에서, 한 계층의 기능이 하위 계층과 기능적으로 중복된다는 결점이 있다. 예를 들어, 많은 프로토콜 스택이 링크와 종단 시스템 두 곳 모두에서 오류 복구 기능을 제공한다.  
또한, 어느 한 계층에서의 기능이 다른 계층에만 존재하는 정보(timestamp 등)를 필요로 할 수 있다는 것인데 이는 계층을 분리하는 목적에 위배된다.    

## 1. 인터넷 프로토콜 계층
### 1-1. 응용(Application) 계층
네트워크 애플리케이션과 `HTTP`, `SMTP`, `FTP` 등의 많은 애플리케이션 계층 프로토콜이 있다.  
도메인을 32비트 네트워크 주소로 변환하는 기능을 돕는 `DNS`

<u>전송 단위는 Message</u>

### 1-2. 전송(Transport) 계층
클라이언트와 서버 간에 애플리케이션 계층 메시지를 전송하는 서비스를 제공하며 `TCP`, `UDP`라는 두 가지 프로토콜이 있다.  

`TCP`는 애플리케이션에게 연결 지향형 서비스를 제공한다. 목적지로의 메시지 전달 보장과 흐름제어(송신/수신자의 속도 일치)를 포함한다. 또한 긴 메시지를 짧은 메시지로 나누고 혼잡제어 기능을 제공하여 네트워크가 혼잡할 때 출발지의 전송속도를 줄이도록 한다.  

`UDP`는 비연결형 서비스를 제공한다. 이 서비스는 신뢰성, 흐름제어, 혼잡제어를 제공하지 않는 아주 간단한 서비스다.

<u>전송 단위는 Segment</u>

### 1-3. 네트워크 계층
한 호스트에서 다른 호스트로 <u>Datagram을 라우팅</u>하는 책임을 진다.  

출발지 호스트에서 전송 계층에서 Segment와 목적지 주소를 네트워크 계층으로 전달하면 네트워크 계층은 목적지 호스트의 전송 계층으로 Segment를 운반하는 서비스를 제공한다.  

크게 두 가지 요소를 가지는데, 하나는 IP Datagram의 필드를 정의하며 종단 시스템과 라우터가 이 필드에 어떻게 동작하는지를 정의하는 **IP 프로토콜**과 두 번째로 출발지와 목적지 사이에서 Datagram이 이동하는 경로를 결정하는 **라우팅 프로토콜**을 포함한다.

<u>전송 단위는 Datagram</u>

### 1-4. 데이터 링크 계층
경로상의 한 노드에서 다른 노드로 패킷을 이동하기 위해, 네트워크 계층은 링크 계층 서비스를 의존해야 한다.  
특히 각 노드에서 네트워크 계층은 Datagram을 아래 링크 계층으로 보내고 링크 계층은 그 Datagram을 경로상의 다음 노드에 전달한다. 다음 노드에서 링크 계층은 그 Datagram을 상위 네트워크 계층으로 보낸다.

Datagram이 출발지에서 목적지로 가는 데 여러 링크를 거치므로 링크 계층에서 제공하는 서비스는 그 링크에서 채용된 특정 링크 계층 프로토콜에 의해 결정된다. 따라서 경로상의 서로 다른 링크에서 다른 링크 계층 프로토콜에 의해 처리될 수 있다.

링크 계층 프로토콜의 예로 이더넷, 와이파이, 케이블 접속 네트워크의 DOCSIS가 있다.  

<u>전송 단위는 Frame</u>

### 1-5. 물리(Physical) 계층
Frame 내부의 각 비트를 한 노드에서 다음 노드로 이동하는 기능.
물리 계층 프로토콜들은 링크에 의존하며 나아가 링크의 실제 전송 매체(꼬임쌍선, 단일 모드 광케이블)에 의존한다.  
예를 들어 이더넷은 여러 가지 물리 계층 프로토콜을 갖고 있다.(꼬임쌍선을 위한 것, 동축케이블을 위한 것, 광케이블을 위한 것 등). 각각 다른 방식으로 비트가 링크 반대편으로 이동된다.

<u>전송 단위는 Bit</u>

## 2. OSI 7 계층
인터넷 프로토콜 계층과 비슷하게 이름 붙여진 계층을 제외하고 2개의 추가 계층(표현, 세션)을 추가하여 설명한다.

### 2-1. 표현(Presentation) 계층
통신하는 애플리케이션들이 교환되는 데이터의 의미를 해석하도록 하는 서비스를 제공한다. 데이터 기술 뿐만 아니라 데이터 압축, 암호화를 포함한다.  
데이터 기술은 애플리케이션이 데이터가 표현/저장되는 내부 포맷을 걱정하지 않아도 되게 해준다.

### 2-2. 세션(Session) 계층
데이터 교환의 경계와 동기화를 제공한다. 체킹 포인트와 회복 방법을 세우는 수단을 포함한다.

<div markdown="1">
인터넷에 OSI 참조 모델의 2개 계층이 없다는 사실은 다음 두 가지 질문을 하게 만든다.
* 이 두 계층이 제공하는 서비스는 중요하지 않은가?
* 애플리케이션이 이 서비스 중 하나를 요구하면 어떻게 되는가?

이것은 애플리케이션 개발자에게 달려있다. 그 서비스가 중요하다면 그 기능을 애플리케이션에 넣는 것은 그 에게 달려있는 것이다.
</div>
{:.note}

## 물리(Physical) 계층
전기적, 기계적, 기능적인 특성을 이용해서 <u>통신 케이블로 데이터를 전송</u>한다.  
이 계층에서는 데이터를 전달할 뿐 **전송 하려는/받으려는 데이터가 무엇인지, 어떤 에러가 있는지 등을 전혀 신경쓰지 않는다.** 단지 데이터를 전기적인 신호로 변환해서 주고받는 기능만 한다.

통신 케이블, 리피터, 허브 등이 있다. <u>전송 단위는 Bit</u>

## 데이터 링크(Data Link) 계층
브릿지, 스위치를 통해 **MAC 주소**를 가지고 물리 계층에서 받은 정보를 전달한다.

Point to Point 간 신뢰성 있는 전송을 보장하기 위한 계층, CRC 기반의 **오류제어와 흐름제어**를 한다.  
오류를 감지하면 재전송하는 방법으로 처리한다.

<u>전송 단위는 Frame</u>

## 네트워크(Network) 계층
여러 개의 노드를 거칠 때마다 **경로를 찾아주는 역할**을 하는 계층.  

라우팅, 흐름제어, 세그먼테이션, 오류 제어, Internetworking 등을 수행한다.

<u>전송 단위는 Datagram(Packet)</u>

## 전송(Transport) 계층
<u>통신을 활성화하기 위한 계층이며 보통 TCP 프로토콜을 이용</u>한다.

양 끝단(End to End)의 사용자들이 신뢰성있는 데이터를 주고 받을 수 있도록 해주며 상위 계층들이 데이터 전달의 유효성이나 효율성을 생각하지 않도록 해준다. (오류 제어 및 흐름제어)

<u>전송 단위는 Segment</u>

## 세션(Session) 계층
데이터가 통신하기 위한 논리적인 연결을 한다.  
(하지만 전송 계층에서도 연결을 맺고 종료할 수 있기 때문에 우리가 어느 계층에서 통신이 끊어졌나 판단하기에는 한계가 있다. 그러므로 세션 계층은 전송 계층과 무관하게 응용프로그램 관점에서 봐야 한다.)  

세션 설정, 유지, 종료, 전송 중단시 복구(운영체제가 수행) 등, 동시 송수신(Duplex), 전이중, 반이중 방식의 통신의 기능


## 표현(Presentation) 계층
코드 간의 번역을 담당하며 사용자 시스템에서 데이터의 형식상 차이를 다루는 부담을 응용 계층으로부터 덜어준다.  
MIME 인코딩이나 함호화 등의 동작이 이 계층에서 이루어진다.  
예를 들어 EBCDIC로 인코딩된 문서 파일을 ASCII로 인코딩된 파일로 바꿔주는 것이다.

포장 / 압축 / 암호화 기능

## 응용(Application) 계층
응용 프로세스와 직접 관계하여 일반적인 응용 서비스를 수행한다. 일반적인 응용 서비스는 관련된 응용 프로세스들 사이의 전환을 제공한다.