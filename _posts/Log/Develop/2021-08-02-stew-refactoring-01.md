---
layout: post
title: Refactor STEW(1) - 시작
category:
    - log
    - develop
tags:
    - stew
description: >
  SSAFY에서의 첫 프로젝트 [STEW](/project/2020-07-13-stew/)의 리팩토링겸 늦은 회고를 시작합니다.
sitemap: false
---
# Refactor STEW(1) - 시작

* toc
{:toc}

## 시작하기 전에..

STEW의 리팩토링을 시작하기 전에, 이 프로젝트의 리팩토링을 하고자 하는 이유에 대해서 먼저 말하자면..  

SSAFY를 하면서 많은 것을 얻고, 배웠고 2학기 과정의 프로젝트들 각각에서 최대한 의미있는 경험을 하기위해 노력했다.

그 과정에서 점점 능숙해져왔다는 생각을 가지고 있는데, 그 만큼 첫 프로젝트인 <u>STEW</u>는 가장 미숙했다. 공부하는 방법을 알아가는 과정이었고 하나의 문제를 해결하기 위해 머리가 아플 정도로 고민한 적도 있었다. 그만큼 가장 열정적이었고 애정이 있었다. 그래서 좋은 결과물로 남겨두고 싶은 마음에 고치기로 한 것이다.

물론 미래의 내가 봤을 때 여전히 미숙해보일테지만요! 😆

## 하고자 하는 것

* TDD
* OOP
* **불필요한 코드, 난잡한 코드 정리**
* 기초지식 정리

### TDD

가장 기본적으로 되어있어야된다고 생각하는 부분이다.

앞으로 굉장히 많은 코드가 추가/삭제/수정될텐데 다른 많은 코드들이 정상 동작하는지 그때그때 확인하는 건 너무 어려운일이다..

여기서 목표는 높은 코드 커버리지를 유지하는 테스트 코드 작성이지만 테스트 결과가 자명한 로직에 대해서는 우선순위를 낮추고 진행할 것이다.

괜히 100% 만들려고 하다가 늘어질까봐..

#### 문서화

개발 당시에는 <u>Swagger</u>를 이용해서 나름의 문서화를 했었는데 뒤에서는 시간에 쫓겨 제대로 활용하지 못했었다. 

이번엔 <u>Spring Rest Docs</u>를 통해 문서화를 할 계획이다.

##### 왜 Swagger를 안쓰냐 하면..

내가 작성한 코드들 사이에 문서화를 위한 코드들이 삽입되어야 한다는게 가장 큰 단점으로 다가왔기 때문이다.  

어노테이션이 한 두개 붙는 것도 아니고 여러 개 붙으면서 가독성을 떨어뜨리고, 다른 어노테이션과 혼재해야된다는게 가장 큰 문제로 여겨졌다.

물론 UI가 깔끔하고 테스트할 수 있는 환경을 제공한다는 것은 장점이다.

반면 **Rest Docs**는 테스트 코드에 기반하여 작성된다. 따라서 위와 같은 단점이 없고 문서의 신뢰도를 높일 수 있다는 장점이 있다.

### OOP

<u>객체 지향 프로그래밍..</u> 학부 시절부터 정말 많이 들었던 말이고 그 대표적인 언어인 **Java**를 쓰면서 한 번도 제대로 공부해본 적이 없었다.

물론 **SOLID** 라던지.. 이론적인 부분은 공부했지만 직접 설계하는 건 다른 문제니까. 

그래서 객체 지향적인 설계란 무엇인가에 대한 생각을 좀 해보려고 한다.

### 불필요한 코드, 난잡한 코드 정리

좋은 코드란 깔끔하고 읽기 좋은 코드라고 생각한다.  

읽기 좋은 코드란 주석이나 추가 설명 없이도 다른 사람(+ 미래의 나)이 쉽게 이해할 수 있는 코드다.

다음 규칙들을 따라서 읽기 좋은 코드를 작성해보도록 할 것이다.

* literal은 상수로 빼서 의미를 쉽게 알 수 있도록 하자
    * `enum` 활용
* 메소드가 길어지면 여러 메소드로 분리하는 것을 고려
    * 한 번 밖에 안쓰일 로직이라면 Block 단위로 나누는 것을 고려
        * 이 때는 주석이 필요해 보임
    * 메소드 이름은 짧고 명확하게 해당 메소드가 하는 일을 표현할 것
* 분기문 최소화
    * OOP에서 분기들은 다형성으로 리팩토링할 수 있다.
        * <u>Strategy 패턴</u>
        * 디버깅, 유지보수가 힘들 수 있다. 당연히 적당한 선을 지켜야한다.

### 기초지식 정리

현재 코드를 보다보니까 지금도 부족한 점이 많다.

따라서 부족한 부분들에 대한 학습도 진행하면서 적용하고자 한다.

현재 정리해두고자 하는 것들은 다음과 같다.

* 적절한 Http 상태코드 사용하기
    * 지금 응답 형태는 200 응답에 바디로 status, message를 가지고 있다.
    * 이런 형태는 옛날에 쓰이던 방식이라고 한다..
    * 아무튼 적절한 상태코드를 응답함으로써 클라이언트에서 이를 적절히 활용할 수 있도록 할 것이다.
* JPA 잘 쓰기
    * JPA 책을 보다가 말았었는데 초반부만 봐도 JPA를 제대로 사용하고 있지 않았다는 것을 알 수 있었다. 책을 마저 보며 제대로 써보도록 할 것이다.
* WebRTC
    * 내 기억에 **WebRTC TURN서버**를 공개된 소스 그대로 사용했던 것으로 기억한다.
        * 사실 TURN 서버가 맞는지도 모르겠다.
        * 현재 그 서버 소스는 저장되어있지 않다.
    * 6인 이상 접속이 안되거나, 특정 인원들이 서로 안보이는 등 문제가 있었다.
    * WebRTC 서버를 직접 개발하여 당시 있었던 문제들을 해결할 것이다.